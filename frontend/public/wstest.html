<!DOCTYPE HTML>
<html>
   <head>
     <title>Tradebot Real-Time Charting</title>
      <script type="text/javascript">
         function Tradebot() {
            if ("WebSocket" in window) {
               var ws = new WebSocket("ws://localhost:8080/chart");
               ws.onopen = function() {
                  ws.send(JSON.stringify({message: "ping"}));
               };
               ws.onmessage = function (evt) {
                  var received_msg = JSON.parse(evt.data);
                  console.log(received_msg);

                  for (var key in received_msg) {

//                      console.log(key + " -> " + received_msg[key]);
                      var attrName = key.toLowerCase();
                      var attrValue = received_msg[key];

                      try {
                        document.getElementById(attrName).innerHTML = attrValue;
                      }
                      catch(e) {
                        console.error(e)
                      }
                  }
               };
               ws.onclose = function() {
                  console.log("Connection is closed...");
               };
               window.onbeforeunload = function(event) {
                  socket.close();
               };
            } else {
               alert("WebSocket NOT supported by your Browser!");
            }
         }
         window.onload = function() {
           Tradebot()
         }
      </script>
      <style type="text/css">
        #container {
          width: 600px;
          clear: both;
        }
        #value {
          float: right;
        }
        label {
          float: left;
          width: 175px;
        }
      </style>
   </head>
   <body>
     <div id="container">
       <label>Currency:</label>
       <div id="currency" class="value"></div>
     </div>
      <div id="container">
        <label>Price:</label>
        <div id="price" class="value"></div>
      </div>
      <div id="container">
        <label>Bollinger (upper):</label>
        <div id="bband_upper" class="value"></div>
      </div>
      <div id="container">
        <label>Bollinger (middle):</label>
        <div id="bband_middle" class="value"></div>
      </div>
      <div id="container">
        <label>Bollinger (lower): </label>
        <div id="bband_lower" class="value"></div>
      </div>
      <div id="container">
        <label>MACD:</label>
        <div id="macd_value" class="value"></div>
      </div>
      <div id="container">
        <label>MACD Signal:</label>
        <div id="macd_signal" class="value"></div>
      </div>
      <div id="container">
        <label>MACD Histogram:</label>
        <div id="macd_histogram" class="value"></div>
      </div>
      <div id="container">
        <label>MACD (live):</label>
        <div id="macd_value_live" class="value"></div>
      </div>
      <div id="container">
        <label>MACD Signal (live):</label>
        <div id="macd_signal_live" class="value"></div>
      </div>
      <div id="container">
        <label>MACD Histogram (live):</label>
        <div id="macd_histogram_live" class="value"></div>
      </div>
      <div id="container">
        <label>RSI:</label>
        <div id="rsi" class="value"></div>
      </div>
      <div id="container">
        <label>RSI (live):</label>
        <div id="rsi_live" class="value"></div>
      </div>
   </body>
</html>
